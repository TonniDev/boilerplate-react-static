{"version":3,"sources":["plugins.js"],"names":["path","require","webpack","StaticSiteGeneratorPlugin","BrowserSyncPlugin","CleanWebpackPlugin","CopyWebpackPlugin","BundleAnalyzerPlugin","ss","outputDir","process","env","OUTPUT","copyPlugin","copyHTML","from","ROOT_PATH","to","concat","ifDev","arr","plugins","StaticSiteGenerator","entry","paths","routes","splice","NODE_ENV","UglyJS","optimize","UglifyJsPlugin","minimize","comments","compress","warnings","pure_getters","conditionals","sequences","dead_code","booleans","unused","if_return","join_vars","drop_console","mangle","sourceMap","output","IgnorePlugin","NameModules","NamedModulesPlugin","NoEmit","NoEmitOnErrorsPlugin","BrowserSync","host","port","PORT","server","baseDir","BundleAnalyser","initialPlugins","root","resolve","__dirname","AggressiveMergingPlugin","minSizeReduce","moveToParents","ModuleConcatenationPlugin","module","exports"],"mappings":"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","file":"plugins.js","sourcesContent":["const path = require('path');\nconst webpack = require('webpack');\nconst StaticSiteGeneratorPlugin = require('static-site-generator-webpack-plugin');\nconst BrowserSyncPlugin = require('browser-sync-webpack-plugin');\nconst CleanWebpackPlugin = require('clean-webpack-plugin');\nconst CopyWebpackPlugin = require('copy-webpack-plugin');\nconst {BundleAnalyzerPlugin} = require('webpack-bundle-analyzer');\nconst ss = require('../../src/__static__/ss_routes');\n\nconst outputDir = process.env.OUTPUT;\n\nconst copyPlugin = () => {\n  let copyHTML = [\n    {\n      from: `${process.env.ROOT_PATH}src/assets/`,\n      to: `${process.env.ROOT_PATH}assets/`\n    }\n  ];\n  if (process.env.OUTPUT === 'standard') {\n    copyHTML = copyHTML.concat({\n      from: `${process.env.ROOT_PATH}src/__${outputDir}__/index.html`,\n      to: `${process.env.ROOT_PATH}`\n    });\n  }\n  return copyHTML;\n};\n\nconst ifDev = (arr) => {\n  let plugins = arr;\n  if (process.env.OUTPUT === 'static') {\n    const StaticSiteGenerator = new StaticSiteGeneratorPlugin({\n      entry: 'main',\n      paths: ss.routes\n    });\n    plugins.splice(2, 0, StaticSiteGenerator);\n  }\n  if (process.env.NODE_ENV === 'production') {\n    const UglyJS = new webpack.optimize.UglifyJsPlugin({\n      minimize: true,\n      comments: false, // remove comments\n      compress: {\n        warnings: false, // Suppress uglification warnings\n        pure_getters: true,\n        conditionals: true,\n        sequences: true,\n        dead_code: true,\n        booleans: true,\n        unused: true,\n        if_return: true,\n        join_vars: true,\n        drop_console: true\n      },\n      mangle: true,\n      sourceMap: true, /* fix issue on uglify */\n      output: {comments: false}\n    });\n    const IgnorePlugin = new webpack.IgnorePlugin(/^\\.\\/locale$/, [/moment$/]);\n    const NameModules = new webpack.NamedModulesPlugin();\n    const NoEmit = new webpack.NoEmitOnErrorsPlugin();\n\n    plugins.splice(2, 0, UglyJS);\n    plugins = plugins.concat(IgnorePlugin, NameModules, NoEmit);\n  }\n  if (process.env.NODE_ENV === 'development') {\n    const BrowserSync = new BrowserSyncPlugin({\n      host: 'localhost',\n      port: process.env.PORT || 8080,\n      server: {\n        baseDir: [`${outputDir}_build`]\n      }\n    });\n    const BundleAnalyser = new BundleAnalyzerPlugin();\n    plugins = plugins.concat(BrowserSync, BundleAnalyser);\n  }\n  return plugins;\n};\n\nconst initialPlugins = [\n  new CleanWebpackPlugin([`${outputDir}_build`], {\n    root: path.resolve(__dirname, '../../')\n  }),\n  new CopyWebpackPlugin(copyPlugin()),\n  new webpack.optimize.AggressiveMergingPlugin({\n    minSizeReduce: 1.5,\n    moveToParents: true\n  }),\n  new webpack.optimize.ModuleConcatenationPlugin()\n];\n\nmodule.exports = ifDev(initialPlugins);\n"]}